<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>JYK目标管理</title>
		<link rel="shortcut icon" href="favicon.ico">
		<link href="../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
		<link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
		<link href="../css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<link href="../css/animate.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../js/plugins/layer/default/layer.css">
		<link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
		<link href="../css/plugins/jsTree/style.min.css" rel="stylesheet">
		<link href="../css/common.css" rel="stylesheet">
		<style type="text/css">
			.tree-div:after {content: " ";position: absolute;right: 10px;top: 0;height: 100vh;border-left: 1px solid #9E9E9E;}
		</style>
	</head>
	<body>
		<div class="container-fluid animated fadeInRight search-content">
			<div class="row">
				<div class="col-xs-3 tree-div">
					<div id="tree1"></div>
				</div>
				<div class="col-xs-9">
					<div class="col-sm-12" style="padding: 5px 15px;">
						<div data-toggle="buttons" class="btn-group">
							<label class="btn btn-sm btn-white active">
								<input type="radio" id="option1" name="options">在建合同储备</label>
							<label class="btn btn-sm btn-white">
								<input type="radio" id="option2" name="options">海外机构经营表</label>
							<label class="btn btn-sm btn-white">
								<input type="radio" id="option3" name="options">重大合同签约表</label>
							<label class="btn btn-sm btn-white">
								<input type="radio" id="option4" name="options">境内海外公司业务表</label>
						</div>
					</div>
					<table id="table" data-toggle="table" >
						<thead>
							<tr>
								<th data-formatter="thIndex" data-align="center" data-width="3%">序号</th>
								<th data-field="name" data-align="center">指标名称</th>
								<th data-field="v1" data-align="center">年度计划</th>
								<th data-field="v2" data-align="center">1-3月累计完成</th>
								<th data-field="v3" data-align="center">当期累计</th>
								<th data-field="v4" data-align="center">上年同期</th>
								<th data-field="v5" data-align="center">同比增减</th>
								<th data-field="s1" data-align="center">年度计划完成率</th>
								<th data-field="s2" data-align="center">与序时进度比</th>
							</tr>
						</thead>
					</table>
				</div>
			</div>
		</div>
		<script src="../js/jquery.min.js?v=2.1.4"></script>
		<script src="../js/bootstrap.min.js?v=3.3.5"></script>
		<!-- <script src="js/content.min.js?v=1.0.0"></script> -->
		<script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
		<script src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
		<script src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
		<script src="../js/plugins/layer/layer.js"></script>
		<script src="../js/plugins/jsTree/jstree.min.js"></script>
		<script src="common.js"></script>
		<script type="text/javascript">
			var $table = $('#table');
			var names =['营业收入','利润总额','净利润','EVA','成本费用占营收比例(%)','营业成本','销售费用','财务费用','应收账款','管理成本'];
			function setDatas(){
				var datas = [];
				$.each(names,function(i,e){
					var obj = {name:e};
					$(['v1','v2','v3','v4','v5']).each(function(a,b){
						var val = Math.floor(Math.random()*800000)+40000;
						if(i==4){
							obj[b] = Math.floor(Math.random()*30)+10 +'%'; return true;
						}
						obj[b] = val;
					});
					$(['s1','s2']).each(function(a,b){
						var val = Math.floor(Math.random()*30)+10 +'%';
						obj[b] = val;
					});
					datas.push(obj);
				});
				$table.bootstrapTable('load', datas);
			}
			$('.btn-white').click(setDatas);
			$(function() {
				var trees = [//此为数据格式,更多结构请参考api文档
					{text:"集团总部",type:'top',state:{opened:true},children:[
						{text:"中核中原",type:'mid'},
						{text:"中核二二",type:'mid',children:[
							{text:"华中区域公司",type:'bot'},
							{text:"华东区域公司",type:'bot'},
							{text:"华南区域公司",type:'bot'},
							{text:"西北区域公司",type:'bot'},
							{text:"西南区域公司",type:'bot'}
						]},
						{text:"中核二三",type:'mid'},
						{text:"中核二四",type:'mid'},
						{text:"中核华兴",type:'mid'},
						{text:"中核华辰",type:'mid'},
						{text:"中核机械",type:'mid'},
						{text:"中核五建",type:'mid'},
						{text:"中核检修",type:'mid',children:[
							{text:"中核检修深圳分公司",type:'bot'},
							{text:"中核检修海盐分公司",type:'bot'},
							{text:"中核检修连云港分公司",type:'bot'},
							{text:"中核检修大连分公司",type:'bot'},
							{text:"中核检修福鼎分公司",type:'bot'}
						]}
					]}
				];
				$('#tree1').jstree({core : {data : trees}}).on('select_node.jstree',function(a,b,c){
					console.log(a,b,c);
					setDatas();
				});
				//setDatas();
			});

			function search() { //查询方法
				$table.bootstrapTable('refresh');
			}

			function toM(val) {
				if(val == '未开始')return '<a href="javascript:layer.msg(\'激活成功\');">激活</a> | <a href="javascript:edit(1);">修改</a>';
				else return '<a href="javascript:edit(2);">查看</a>';
			}

			function edit(a) { //编辑方法(推荐)
				layer.open({
					type: 2,
					title: '数据采集信息',
					content: "form_2.1.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(a); //执行子页面写入数据方法
					}
				});
			}

			function edit2() { //添加方法(推荐)
				layer.open({
					type: 2,
					title: '数据填报',
					content: "table_1.2.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function edit3() { //添加方法(推荐)
				layer.open({
					type: 1,
					title: '数据填报',
					content: "<img src='img/lc-img.png'></img>",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function getSelections() { //获取所选行方法
				return $table.bootstrapTable('getSelections');
			}

			function toDetail(val, row) {
				return '<a href="javascript:;" onclick="openDetail(this)">详情</a>';
			}

			function openDetail(e) {
				var index = $(e).parents('tr').data('index');
				var data = $table.bootstrapTable('getData')[index];
				layer.open({
					type: 2,
					title: '员工信息详情',
					content: contextPath + "/demo/testUserinfoForm.jsp",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(data, 'read'); //执行子页面写入数据方法
					}
				});
			}

			function remove() { //删除方法
				var selRows = getSelections();
				if (selRows.length == 0) {
					sweetAlert("错误", "请先选择行", "error");
					return;
				}
				layer.confirm('删除所选项？', {
					btn: ['删除', '取消'] //按钮
				}, function() {
					$({
						datas: selRows
					}).post('com.primeton.demo.test.deleteTestUserinfos.biz.ext', function(h) {
						if (h.exception == null) {
							layer.msg('删除成功');
							$table.bootstrapTable('refresh');
						} else {
							layer.msg('删除失败');
						}
					});
				});
			}

			function exports() {
				$('.export li[data-type=xlsx]').click();
			}
		</script>
	</body>
</html>
