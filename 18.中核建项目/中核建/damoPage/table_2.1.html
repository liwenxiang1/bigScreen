<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>数据审核列表</title>
		<link rel="shortcut icon" href="favicon.ico">
		<link href="../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
		<link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
		<link href="../css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<link href="../css/animate.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../js/plugins/layer/default/layer.css">
		<link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
		<link href="../css/common.css" rel="stylesheet">
	</head>
	<body>
		<div class="container-fluid animated fadeInRight search-content">
			<div class='panel panel-default' style="margin-bottom: 0;">
				<form id='form1' class="container-fluid search-form">
					<div class="form-group col-sm-4">
						<div class="input-group">
							<div class="input-group-addon">任务名称:</div>
							<input type="text" class="form-control" placeholder="任务名称" />
						</div>
					</div>
					<div class="form-group col-sm-4">
						<div class="input-group">
							<div class="input-group-addon">采集数据源:</div>
							<input type="text" class="form-control" placeholder="采集数据源" />
						</div>
					</div>
					<div class="form-group col-sm-4">
						<div class="input-group">
							<div class="input-group-addon">状态:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>未报</option>
								<option>填报中</option>
								<option>已报</option>
							</select>
						</div>
					</div>
					<div class="form-group col-sm-4">
						<div class="input-group">
							<div class="input-group-addon">入库类型:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>增量</option>
								<option>全量</option>
							</select>
						</div>
					</div>
					<div class="form-group col-sm-4">
						<div class="input-group">
							<div class="input-group-addon">任务描述:</div>
							<input class="form-control" placeholder="任务描述" />
						</div>
					</div>
					<div class="btn-group">
						<button type="button" onclick="search()" class="btn btn-default" title="查询">
							<span class="glyphicon glyphicon-search"></span></button>
						<button type="button" onclick="reset()" class="btn btn-default" title="重置">
							<span class="glyphicon glyphicon-repeat"></span></button>
					</div>
				</form>
			</div>
			<div id="toolbar" class='btn-group'>
				<button id="btn_add" onclick="edit()" type="button" class="btn btn-default">
					<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新建
				</button>
				<button onclick="exports()" type="button" class="btn btn-default">
					<span class="glyphicon glyphicon-export" aria-hidden="true"></span>导出
				</button>
			</div>
			<table id="table" data-toggle="table" data-toolbar="#toolbar" data-show-refresh="true" data-show-columns="true"
			 data-show-export="true" data-click-to-select="true" data-export-types="['xlsx']" data-pagination="true">
				<thead>
					<tr>
						<th data-formatter="thIndex" data-align="center" data-width="3%">序号</th>
						<th data-field="ys" data-align="center" data-formatter="toM">操作</th>
						<th data-field="ys" data-align="center" data-colors="已完成:#4CAF50,采集中:red,未开始:#9C27B0" data-formatter="thColors">状态</th>
						<th data-field="name" data-align="center">任务名称</th>
						<th data-field="form" data-align="center">数据源</th>
						<th data-field="type" data-align="center">入库类型</th>
						<th data-field="remark" data-align="center">任务描述</th>
						<th data-field="table" data-align="center">关联报表</th>
						<th data-field="stadate" data-align="center">开始时间</th>
						<th data-field="enddate" data-align="center">结束时间</th>
					</tr>
				</thead>
			</table>
		</div>
		<script src="../js/jquery.min.js?v=2.1.4"></script>
		<script src="../js/bootstrap.min.js?v=3.3.5"></script>
		<!-- <script src="js/content.min.js?v=1.0.0"></script> -->
		<script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
		<script src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
		<script src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
		<script src="../js/plugins/layer/layer.js"></script>
		<script src="common.js"></script>
		<script type="text/javascript">
			var $table = $('#table');
			var datas = [
				{ys:'已完成',name:'二二公司月报采集任务',form:'CNNC-22-MDM-01',type:'增量',remark:'月报采集任务',table:'中核二二合同产值表',stadate:'2020/4/1 22:00',enddate:'2020/4/1 22:10'},
				{ys:'已完成',name:'二三公司月报采集任务',form:'CNNC-23-MDM-01',type:'增量',remark:'月报采集任务',table:'中核二三合同产值表',stadate:'2020/4/1 22:00',enddate:'2020/4/1 22:10'},
				{ys:'采集中',name:'二四公司月报采集任务',form:'CNNC-24-MDM-01',type:'增量',remark:'月报采集任务',table:'中核二四合同产值表',stadate:'2020/4/30 22:00',enddate:''},
				{ys:'未开始',name:'中核中原月报采集任务',form:'CNNC-ZY-MDM-01',type:'增量',remark:'月报采集任务',table:'中核中原合同产值表',stadate:'',enddate:''},
				{ys:'未开始',name:'中核华兴月报超级任务',form:'CNNC-HX-MDM-01',type:'增量',remark:'月报采集任务',table:'中核华兴合同产值表',stadate:'',enddate:''}
			];
			$(function() {
				$table.bootstrapTable('load', datas);
			});

			function search() { //查询方法
				$table.bootstrapTable('refresh');
			}

			function toM(val) {
				if(val == '未开始')return '<a href="javascript:layer.msg(\'激活成功\');">激活</a> | <a href="javascript:edit(1);">修改</a>';
				else return '<a href="javascript:edit(2);">查看</a>';
			}

			function edit(a) { //编辑方法(推荐)
				layer.open({
					type: 2,
					title: '数据采集信息',
					content: "form_2.1.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(a); //执行子页面写入数据方法
					}
				});
			}

			function edit2() { //添加方法(推荐)
				layer.open({
					type: 2,
					title: '数据填报',
					content: "table_1.2.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function edit3() { //添加方法(推荐)
				layer.open({
					type: 1,
					title: '数据填报',
					content: "<img src='img/lc-img.png'></img>",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function getSelections() { //获取所选行方法
				return $table.bootstrapTable('getSelections');
			}

			function toDetail(val, row) {
				return '<a href="javascript:;" onclick="openDetail(this)">详情</a>';
			}

			function openDetail(e) {
				var index = $(e).parents('tr').data('index');
				var data = $table.bootstrapTable('getData')[index];
				layer.open({
					type: 2,
					title: '员工信息详情',
					content: contextPath + "/demo/testUserinfoForm.jsp",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(data, 'read'); //执行子页面写入数据方法
					}
				});
			}

			function remove() { //删除方法
				var selRows = getSelections();
				if (selRows.length == 0) {
					sweetAlert("错误", "请先选择行", "error");
					return;
				}
				layer.confirm('删除所选项？', {
					btn: ['删除', '取消'] //按钮
				}, function() {
					$({
						datas: selRows
					}).post('com.primeton.demo.test.deleteTestUserinfos.biz.ext', function(h) {
						if (h.exception == null) {
							layer.msg('删除成功');
							$table.bootstrapTable('refresh');
						} else {
							layer.msg('删除失败');
						}
					});
				});
			}

			function exports() {
				$('.export li[data-type=xlsx]').click();
			}
		</script>
	</body>
</html>
