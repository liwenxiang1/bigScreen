<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>项目看板</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link href="../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
    <link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="../css/animate.min.css" rel="stylesheet">
    <link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
    <link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <!-- <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
    <link href="../css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
    <link href="../css/common.css" rel="stylesheet">
    <style type="text/css">
        p {
            margin: 0;
        }

        #project-list {
            width: 100%;
            margin: 30px auto;
            margin: 0 auto;
            color: #7A7C7E;
        }

        #project-list .project-item {
            height: 100px;
            width: 100%;
            max-width: 250px;
            margin: 15px auto;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);
            border-radius: 5px;
            -webkit-transition: all .3s;
            transition: all .3s;
            cursor: pointer;
        }
        #project-list .project-item:hover {
            -webkit-transform: scale(1.1);
                    transform: scale(1.1);
        }

        #project-list .project-item .item-title {
            position: relative;
            width: 100%;
            padding: 0 10px;
            line-height: 30px;
            font-size: 14px;
            font-weight: 500;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        #project-list .project-item .item-title .mark {
            position: absolute;
            display: block;
            right: 5px;
            top: 50%;
            -webkit-transform: translateY(-50%) scale(0.7);
                    transform: translateY(-50%) scale(0.7);
            padding: 5px 10px;
            line-height: 12px;
            color: #fff;
            font-size: 12px;
            background-color: #3A8FD0;
            border-radius: 3px;
        }

        #project-list .project-item .item-content {
            padding: 5px 10px;
        }

        #project-list .project-item .item-content .amount {
            font-size: 28px;
            letter-spacing: 1.5px;
        }

        #project-list .project-item .item-content .remark {
            text-align: left;
            font-size: 12px;
        }

        #project-list .project-item .item-content .rote {
            float: right;
        }

        .charts-wrapper {
            width: calc(100% - 60px);
            margin: 30px auto;
            padding: 20px 30px 10px 20px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);
            border-radius: 5px;
        }
        #bar-chart {
            float: left;
            width: calc(100% - 400px);
            height: 350px;
            margin: 0;
        }
        #progress {
            float: left;
            width: 400px;
            height: 350px;
            padding: 20px 0 0 30px;
        }
        #progress .progress-item .amount{
        font-size: 28px;
        color: #999;
        text-align: left;
        line-height: 30px;
        }
        #progress .progress-item .remark{
        font-size: 12px;
        color: #999;
        line-height: 20px;
        text-align: left;
        }
        #progress .progress-item .remark .rote{
        float: right;
        }
        #progress .progress-item .progress-bar-wrapper {
            height: 7px;
            margin: 5px 0 40px 0;
            border-radius: 3px;
            background-color: #f0f0f0;
            overflow: hidden;
        }
        #progress .progress-item .progress-bar-wrapper .progress-bar{
            height: 7px;
            width: 0;
            -webkit-transition: width .5s;
            transition: width .5s;
        }
        .btn-group-wrapper {
            text-align: right;
            margin: 0 0 10px 0;
        }
        .table-wrapper {
            width: calc(100% - 60px);
            margin: 15px auto;
        }
        .table-wrapper .table-item{
            height: 245px;
            overflow: auto;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);
            border-radius: 5px;
        }
        .table-wrapper .table-item .table-item-title{
            padding: 0 10px;
            line-height: 30px;
            font-size: 14px;
            font-weight: 500;
            color: #999;
            border-bottom: 1px solid #eee;
            text-align: left;
            background-color: #f0f0f0;
        }
        .table-wrapper .table-col:nth-of-type(1){
            padding-left: 0;
        }
        .table-wrapper .table-col:nth-of-type(3){
            padding-right: 0;
        }
    </style>
</head>

<body>
    <div class="project-panel container-fluid animated fadeInRight search-content">
        <p class="info-title t-tag" style="margin:15px 0 0 0;font-size: 18px;">组织：</p>
        <div id="project-list" class="row">
        </div>
        <div class="charts-wrapper clearfix">
            <div class="btn-group-wrapper">
                <div data-toggle="buttons" class="btn-group">
                    <label class="btn btn-sm btn-white active" id="year">
                        <input type="radio" name="options">年</label>
                    <label class="btn btn-sm btn-white" id="month">
                        <input type="radio" name="options">月</label>
                    <label class="btn btn-sm btn-white" id="day">
                        <input type="radio" name="options">日</label>
                </div>
            </div>
            <div id="bar-chart"></div>
            <div id="progress">
            </div>
        </div>
        <div class="table-wrapper row">
            <div class="table-col col-sm-4 col-xs-12">
                <div class="table-item">
                    <p class="table-item-title">重大项目开工情况</p>
                    <table id="table"></table>
                </div>
            </div>
            <div class="table-col col-sm-4 col-xs-12">
                <div class="table-item">
                    <p class="table-item-title">重大项目执行情况</p>
                    <table id="table2"></table>
                    <!-- <div id="table1"></div> -->
                </div>
            </div>
            <div class="table-col col-sm-4 col-xs-12">
                <div class="table-item">
                    <p class="table-item-title">单位合同完成情况</p>
                    <table id="table3"></table>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/jquery.min.js?v=2.1.4"></script>
    <script src="../js/bootstrap.min.js?v=3.3.5"></script>
    <script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
    <script src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <!-- <script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts-en.min.js"></script> -->
    <script src="../js/plugins/echarts/echarts.min.js"></script>
    <script src="common.js"></script>
    <script type="text/javascript">
        $(function () {
            listInit()
            chartsInit()
            progressInit()
            tableInit()
        });

        function listInit() {
            const listData = [{
                id:'1',
                name: '新签合同总数',
                amount: (Math.floor(Math.random() * 5000) + 1000).toLocaleString(),
                rote: '98%'
            }, {
                id:'2',
                name: '项目储备总数(总额)',
                amount: (Math.floor(Math.random() * 40000000) + 1000).toLocaleString(),
                rote: '20%'
            }, {
                id:'3',
                name: '在建项目储备总数(总额)',
                amount: (Math.floor(Math.random() * 40000000) + 1000).toLocaleString(),
                rote: '44%'
            }, {
                id:'4',
                name: '开工项目总数(总额)',
                amount: (Math.floor(Math.random() * 40000000) + 1000).toLocaleString(),
                rote: '48%'
            }]
            let listDom = ''
            $.each(listData, (index, val) => {
                const a = (index + 1) % 4;
                if (a === 1) {
                    val['color'] = '#3A8FD0';
                    val['icon'] = 'flash'
                } else if (a === 2) {
                    val['color'] = '#4DCDD0';
                    val['icon'] = 'level-up'
                } else if (a === 3) {
                    val['color'] = '#42BC9E';
                    val['icon'] = 'level-up'
                } else {
                    val['color'] = '#E75F6E';
                    val['icon'] = 'level-down'
                };
                listDom += '<div class="col-sm-3 col-xs-6">'+
                    '<div class="project-item" onclick="showInfo('+ val.id +')">'+
                        '<div class="item-title">'+ val.name +
                            '<span class="mark" style="background-color:'+ val.color +'">全年</span>'+
                        '</div>'+
                        '<div class="item-content">'+
                            '<p class="amount">'+ val.amount +'</p>'+
                            '<p class="remark clearfix">'+
                                '<span class="monnth">当月</span>'+
                                '<span class="rote" style="color:'+ val.color +'">'+
                                    '<span>'+ val.rote +'</span>'+
                                    '<i class="fa fa-'+ val.icon +'"></i>'+
                                '</span></p></div></div></div>'
            })
            $('#project-list').append(listDom)
            
            // $('#project-list').on('click', '.project-item', e=>{
            //     const valId = $(e.currentTarget).attr('valId')
            //     console.log("listInit -> valId", valId)
            // })
        }

        function chartsInit() {
            var barChart = echarts.init(document.getElementById('bar-chart'));
            barChart.setOption({
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: '{a0}: {c0} 万元<br />{a1}: {c1} 万元<br />{a2}: {c2}%'
                },
                grid: {
                    top: '12%',
                    left: '1%',
                    right: '1%',
                    bottom: '8%',
                    containLabel: true,
                },
                legend: {
                    itemGap: 50,
                    data: ['主营收入', '净利润', '资产负债率'],
                },
                xAxis: [{
                    type: 'category',
                    boundaryGap: true,
                    axisLine: { //坐标轴轴线相关设置。数学上的x轴
                        show: true,
                    },
                    axisLabel: { //坐标轴刻度标签的相关设置
                        textStyle: {
                            margin: 15,
                        },
                    },
                    axisTick: {
                        show: false,
                    },
                    data:  ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                }],
                yAxis: [{
                    type: 'value',
                    name:'万元',
                    min: 0,
                    // max: 140,
                    splitNumber: 7,
                    splitLine: {
                        show: true
                    },
                    axisLine: {
                        show: false,
                    },
                    axisLabel: {
                        margin: 20,
                    },
                    axisTick: {
                        show: false,
                    }
                },{
                    type: 'value',
                    name: '负债率',
                    position: "right",
                    splitLine: {
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                    axisLine: {
                        show: false
                    },
                    axisLabel: {
                        show: true,
                        formatter: '{value} %' //右侧Y轴文字显示
                    }
                }],
                series: [{
                    name: '主营收入',
                    type: 'bar',
                    stack: '金额',
                    barWidth: 20,
                    label: {
                        show: true,
                        position: 'top'
                    },
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                            // barBorderRadius: 5,
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [{
                                        offset: 0,
                                        color: '#5accff'
                                    },
                                    {
                                        offset: 1,
                                        color: '#49A9EE'
                                    }
                                ]
                            )
                        }
                    },
                    data: [200, 382, 102, 267, 186, 315, 316, 400, 298, 355, 310, 160]
                },{
                    name: '净利润',
                    type: 'bar',
                    stack: '金额',
                    barWidth: 20,
                    label: {
                        show: true,
                        position: 'top'
                    },
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                            // barBorderRadius: 5,
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [{
                                        offset: 0,
                                        color: '#F3147C'
                                    },
                                    {
                                        offset: 1,
                                        color: '#f3857c'
                                    }
                                ]
                            )
                        }
                    },
                    data: [100, 182, 52, 150, 80, 120, 120, 180, 140, 160, 100, 50]
                },{
                    name: '资产负债率',
                    type: 'line',
                    valueType:"percent",
                    // smooth: true, //是否平滑曲线显示
                    // 			symbol:'circle',  // 默认是空心圆（中间是白色的），改成实心圆
                    yAxisIndex: 1,
                    showAllSymbol: true,
                    symbol: 'emptyCircle',
                    symbolSize: 0,
                    lineStyle:{
                        color: 'rgba(193,146,255,0.52)'
                    },
                    areaStyle: { //区域填充样式
                        normal: {
                            //线性渐变，前4个参数分别是x0,y0,x2,y2(范围0~1);相当于图形包围盒中的百分比。如果最后一个参数是‘true’，则该四个值是绝对像素位置。
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                    offset: 0,
                                    color: 'rgba(193,146,255,0.52)'
                                },
                                {
                                    offset: 1,
                                    color: 'rgba(0,0,0, 0)'
                                }
                            ], false),
                            shadowColor: 'rgba(193,146,255,0.52)', //阴影颜色
                            shadowBlur: 20 //shadowBlur设图形阴影的模糊大小。配合shadowColor,shadowOffsetX/Y, 设置图形的阴影效果。
                        }
                    },
                    data: [10, 12, 7.5, 6.5, 3.2, 1.1, 5.5, 4.3, 6.9, 8.5, 3.2, 1.9]
                }]
            })

            // 窗口尺寸变化时resize
            $(window).resize(function () {
                barChart.resize()
            });
        }
        
        function progressInit(){
            const progressData = [{
                amount: 2467,
                title: '合同总额执行率',
                rote: '48%',
                color: '#42BC9E',
                icon: 'level-up'
            },{
                amount: 4420,
                title: '合同签订执行率',
                rote: '66%',
                color: '#42BC9E',
                icon: 'level-down'
            },{
                amount: 9180,
                title: '新签合同完成率',
                rote: '22%',
                color: '#42BC9E',
                icon: 'flash'
            }];
            let proDom = ''
            $.each(progressData, (index, val)=>{
                proDom += '<div class="progress-item">'+
                    '<p class="amount">'+ val.amount +'</p>'+
                    '<p class="remark">'+
                        '<span class="subname">'+ val.title +'</span>'+
                        '<span class="rote" style="color:'+ val.color +'">'+
                            '<span>'+ val.rote +'</span>'+
                            '<i class="fa fa-'+ val.icon +'"></i>'+
                        '</span>'+
                    '</p>'+
                    '<div class="progress-bar-wrapper">'+
                        '<div class="progress-bar" style="background-color:'+ (val.color || '#42BC9E') +'" rote="'+ val.rote +'"></div>'+
                    '</div>'+
                '..'
            })
            $('#progress').append(proDom)
            $('#progress .progress-bar').each((index, el)=>{
                $(el).width($(el).attr('rote'))
            })
        }
        function showInfo(id){
            console.log("showInfo -> id", id)
            // window.open('project_tabs.html?id='+ id,'_self')

            // $('.btn-group').on('click', '.btn', e=>{
            //     const curType = $(e.currentTarget).attr('id')
            //     console.log("progressInit -> curType", curType);
            //     // 查询刷新
            // })
        }

        function tableInit(){
            const $table = $('#table')
            const $table2 = $('#table2')
            const $table3 = $('#table3')
            // ------------------------------------------------
            const tableColumns = [{
                title: '项目名称',
                field: 'name',
                align: 'center',
            }, {
                title: '开工时间',
                field: 'startTime',
                align: 'center',
                formatter: (value, row, index) => {
                    return '<span class="glyphicon glyphicon-time" aria-hidden="true"></span>' + value
                }
            }, {
                title: '业主',
                field: 'owner',
                align: 'center',
            }]
            const tableData = [{
                id: '1',
                name: '中核二二',
                startTime: '2020-02-01',
                owner: '上海中汽'
            },{
                id: '2',
                name: '中核二三',
                startTime: '2019-10-21',
                owner: '山东广播电视台'
            },{
                id: '3',
                name: '中核二四',
                startTime: '2020-02-01',
                owner: '山东重汽'
            },{
                id: '4',
                name: '中核二五',
                startTime: '2020-02-01',
                owner: '金星消防'
            },{
                id: '5',
                name: '中核中原',
                startTime: '2020-02-01',
                owner: '金星消防'
            }]
            
            $table.bootstrapTable({
                columns: tableColumns,
                data: tableData
            })

            // ------------------------------------------------
            const tableColumns2 = [{
                title: '项目名称',
                field: 'name',
                align: 'center',
            }, {
                title: '业主',
                field: 'owner',
                align: 'center',
            }, {
                title: '完成进度',
                field: 'progress',
                align: 'center',
                // formatter: (value, row, index) => {
                //     return '<span class="glyphicon glyphicon-time" aria-hidden="true"></span>' + value
                // }
            }]
            const tableData2 = [{
                id: '1',
                name: '中核二二',
                progress: '70%',
                owner: '上海中汽'
            },{
                id: '2',
                name: '中核二三',
                progress: '95%',
                owner: '山东广播电视台'
            },{
                id: '3',
                name: '中核二四',
                progress: '100%',
                owner: '山东重汽'
            },{
                id: '4',
                name: '中核二五',
                progress: '100%',
                owner: '金星消防'
            },{
                id: '5',
                name: '中核中原',
                progress: '100%',
                owner: '金星消防'
            }]
             
            $table2.bootstrapTable({
                columns: tableColumns2,
                data: tableData2
            })

            // ------------------------------------------------，，
            const tableColumns3 = [{
                title: '完成合同',
                field: 'contractName',
                align: 'center',
            }, {
                title: '完成总额',
                field: 'amount',
                align: 'center',
            }, {
                title: '排名（按总额）',
                field: 'rank',
                align: 'center',
                // formatter: (value, row, index) => {
                //     return '<span class="glyphicon glyphicon-time" aria-hidden="true"></span>' + value
                // }
            }]
            const tableData3 = [{
                id: '1',
                contractName: '中核二二',
                amount: '418200',
                rank: '1'
            },{
                id: '2',
                contractName: '中核二三',
                amount: '418200',
                rank: '2'
            },{
                id: '3',
                contractName: '中核二四',
                amount: '418200',
                rank: '3'
            },{
                id: '4',
                contractName: '中核二五',
                amount: '418200',
                rank: '4'
            },{
                id: '5',
                contractName: '中核中原',
                amount: '418200',
                rank: '5'
            }]
            
            $table3.bootstrapTable({
                columns: tableColumns3,
                data: tableData3
            })
        }
    </script>
</body>

</html>