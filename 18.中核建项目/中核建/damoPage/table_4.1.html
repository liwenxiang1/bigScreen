<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>营业收入完成情况</title>
		<link rel="shortcut icon" href="favicon.ico">
		<link href="../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
		<link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
		<link href="../css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<link href="../css/animate.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../js/plugins/layer/default/layer.css">
		<link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
		<link href="../css/common.css" rel="stylesheet">
		<style type="text/css">
			td[colspan="2"]{font-weight: 600;} .btn-white.active{border: 1px solid #2196F3};
		</style>
	</head>
	<body>
		<div class="container-fluid animated fadeInRight search-content">
			<div class="row">
				<div class="col-sm-12" style="padding: 5px 15px;">
					<div data-toggle="buttons" class="btn-group">
						<label class="btn btn-sm btn-white active">
							<input type="radio" id="option1" name="options">营业收入完成情况</label>
						<label class="btn btn-sm btn-white">
							<input type="radio" id="option2" name="options">利润总额完成情况</label>
						<label class="btn btn-sm btn-white">
							<input type="radio" id="option3" name="options">净利润完成情况</label>
						<label class="btn btn-sm btn-white">
							<input type="radio" id="option4" name="options">核电+军工完成收入情况</label>
					</div>
				</div>
			</div>
			<table id="table" data-toggle="table">
				<thead>
					<tr>
						<th data-field="index" data-align="center">序号</th>
						<th data-field="unit" data-align="center">单位名称</th>
						<th data-field="v1" data-align="center">全年计划</th>
						<th data-field="v2" data-align="center">当期累计完成</th>
						<th data-field="v3" data-align="center">去年同期累计完成</th>
						<th data-field="s1" data-align="center">同比增长率</th>
						<th data-field="s2" data-align="center">计划完成率</th>
					</tr>
				</thead>
			</table>
			<div id="echarts-1" style="height: 500px;"></div>
		</div>
		<script src="../js/jquery.min.js?v=2.1.4"></script>
		<script src="../js/bootstrap.min.js?v=3.3.5"></script>
		<!-- <script src="js/content.min.js?v=1.0.0"></script> -->
		<script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
		<script src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
		<script src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
		<script src="../js/plugins/layer/layer.js"></script>
		<script src="../js/plugins/echarts/echarts.min.js"></script>
		<script src="common.js"></script>
		<script type="text/javascript">
			var $table = $('#table');
			var units = [
				'中核二二',
				'中核二三',
				'中核二四',
				'中核五公司',
				'中核华兴',
				'中核中原',
				'中核华泰',
				'中核华辉',
				'中核岩土',
				'中核华辰',
				'中核机械',
				'中核建材',
				'和建国际',
				'中核检修',
				'核建财务',
				'中国核建合并数',
				'湘核建',
				'中核兴业',
				'中国核建JYK考核口径数'
			];
			$('.btn-white').click(setDatas);
			function setDatas(){
				var datas = [],index = 1,sum1={v1:0,v2:0,v3:0},sum2={v1:0,v2:0,v3:0};
				$.each(units,function(i,e){
					var _index = index;
					if(i== 15) {_index = '中国核建合并数';index--;}
					if(i== 18) _index = '中国核建JYK考核口径数';
					var obj = {index:_index,unit:e};
					$(['v1','v2','v3']).each(function(a,b){
						var val = Math.floor(Math.random()*400000)+100000;
						if(i<15) sum1[b]+=val;
						if(i<18) sum2[b]+=val;
						if(i==15){
							obj[b] = sum1[b]; return true;
						}
						if(i==18){
							obj[b] = sum2[b]; return true;
						}
						obj[b] = val;
					});
					$(['s1','s2']).each(function(a,b){
						var val = Math.floor(Math.random()*30)+10 +'%';
						obj[b] = val;
					});
					datas.push(obj);
					index++;
				});
				$table.bootstrapTable('load', datas);
				$table.bootstrapTable('mergeCells', {index: 15, field: 'index', colspan: 2, rowspan: 1});
				$table.bootstrapTable('mergeCells', {index: 18, field: 'index', colspan: 2, rowspan: 1});
				setEchats(datas)
			}
			
			$(function() {
				setDatas();
			});
			var myChart = echarts.init(document.getElementById('echarts-1'));
			var colors = ['#EF5350','#2196F3','#607D8B','#ffb74d','#4caf50','#009688','#673ab7'];
			function setEchats(datas){
				var xData = [], data1=[], data2=[];
				$.each(datas,function(i,e){
					if(i==15||i==18) return true;
					xData.push(e.unit);
					data1.push(e.v2);
					data2.push(e.v3);
				});
				var option = {
					color:colors,
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'shadow'
						}
					},
					grid: {
						top: '12%',
						left: '60px',
						right: '20px',
						bottom: '60px'
					},
					legend: {
						data: ['当期','去年同期']
					},
					xAxis: [{
						type: 'category',
						axisTick: {
							alignWithLabel: true
						},
						axisLabel:{
							rotate:-38
						},
						data: xData
					}],
					yAxis: [{
							type: 'value',
							name: '单位:万',
							position: 'left'
						}
					],
					series: [{
							name: '当期',
							type: 'bar',
							data: data1,
						},
						{
							name: '去年同期',
							type: 'bar',
							data: data2,
						}
					]
				};
				myChart.setOption(option);
			}

			function search() { //查询方法
				$table.bootstrapTable('refresh');
			}

			function toM(val) {
				if (val == '未开始') return '<a href="javascript:layer.msg(\'激活成功\');">激活</a> | <a href="javascript:edit(1);">修改</a>';
				else return '<a href="javascript:edit(2);">查看</a>';
			}

			function edit(a) { //编辑方法(推荐)
				layer.open({
					type: 2,
					title: '数据采集信息',
					content: "form_2.1.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(a); //执行子页面写入数据方法
					}
				});
			}

			function edit2() { //添加方法(推荐)
				layer.open({
					type: 2,
					title: '数据填报',
					content: "table_1.2.html",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function edit3() { //添加方法(推荐)
				layer.open({
					type: 1,
					title: '数据填报',
					content: "<img src='img/lc-img.png'></img>",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true
				});
			}

			function getSelections() { //获取所选行方法
				return $table.bootstrapTable('getSelections');
			}

			function toDetail(val, row) {
				return '<a href="javascript:;" onclick="openDetail(this)">详情</a>';
			}

			function openDetail(e) {
				var index = $(e).parents('tr').data('index');
				var data = $table.bootstrapTable('getData')[index];
				layer.open({
					type: 2,
					title: '员工信息详情',
					content: contextPath + "/demo/testUserinfoForm.jsp",
					shadeClose: false,
					area: ['90%', '90%'],
					maxmin: true,
					success: function(layero, index) { //子页面加载完后执行
						var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象
						iframeWin.setData(data, 'read'); //执行子页面写入数据方法
					}
				});
			}

			function remove() { //删除方法
				var selRows = getSelections();
				if (selRows.length == 0) {
					sweetAlert("错误", "请先选择行", "error");
					return;
				}
				layer.confirm('删除所选项？', {
					btn: ['删除', '取消'] //按钮
				}, function() {
					$({
						datas: selRows
					}).post('com.primeton.demo.test.deleteTestUserinfos.biz.ext', function(h) {
						if (h.exception == null) {
							layer.msg('删除成功');
							$table.bootstrapTable('refresh');
						} else {
							layer.msg('删除失败');
						}
					});
				});
			}

			function exports() {
				$('.export li[data-type=xlsx]').click();
			}
		</script>
	</body>
</html>
