<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>填报任务</title>
		<link rel="shortcut icon" href="favicon.ico">
		<link href="../css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
		<link href="../css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
		<link href="../css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
		<link href="../css/animate.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../js/plugins/layer/default/layer.css">
		<link href="../css/style.min.css?v=4.0.0" rel="stylesheet">
		<link href="../css/common.css" rel="stylesheet">
	</head>
	<body >
		<div class="container-fluid animated fadeInRight search-content">
			<div class='panel panel-default' style="margin-bottom: 0;">
				<form id='form1' class="container-fluid search-form">
					<div class="form-group col-sm-3">
						<div class="input-group">
							<div class="input-group-addon">月报类型:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>主要经济指标月报</option>
								<option>主要产出月报</option>
								<option>增加值月报</option>
								<option>能源消耗月报</option>
								<option>新签合同月报</option>
								<option>合同储备月报</option>
							</select>
						</div>
					</div>
					<div class="form-group col-sm-3">
						<div class="input-group">
							<div class="input-group-addon">年度:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>2016年</option>
								<option>2017年</option>
								<option>2018年</option>
								<option>2019年</option>
								<option>2020年</option>
								<option>2021年</option>
							</select>
						</div>
					</div>
					<div class="form-group col-sm-3">
						<div class="input-group">
							<div class="input-group-addon">开始月:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>1月</option>
								<option>2月</option>
								<option>3月</option>
								<option>4月</option>
								<option>5月</option>
								<option>6月</option>
								<option>7月</option>
								<option>8月</option>
								<option>9月</option>
								<option>10月</option>
								<option>11月</option>
								<option>12月</option>
							</select>
						</div>
					</div>
					<div class="form-group col-sm-3">
						<div class="input-group">
							<div class="input-group-addon">结束月:</div>
							<select class="form-control">
								<option>请选择</option>
								<option>1月</option>
								<option>2月</option>
								<option>3月</option>
								<option>4月</option>
								<option>5月</option>
								<option>6月</option>
								<option>7月</option>
								<option>8月</option>
								<option>9月</option>
								<option>10月</option>
								<option>11月</option>
								<option>12月</option>
							</select>
						</div>
					</div>
					<div class="btn-group">
						<button type="button" onclick="search()" class="btn btn-default" title="查询">
							<span class="glyphicon glyphicon-search"></span></button>
						<button type="button" onclick="reset()" class="btn btn-default" title="重置">
							<span class="glyphicon glyphicon-repeat"></span></button>
					</div>
				</form>
			</div>
			<div id="toolbar" class='btn-group'>
				<button id="btn_add" onclick="add()" type="button" class="btn btn-default">
					<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>月报类型
				</button>
				<button id="btn_edit" onclick="edit2()" type="button" class="btn btn-success">
					<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>通用设置
				</button>
				<button onclick="exports()" type="button" class="btn btn-default">
					<span class="glyphicon glyphicon-export" aria-hidden="true"></span>导出
				</button>
			</div>
			<table id="table"
				data-toggle="table"
				data-toolbar="#toolbar" 
				data-show-refresh="true"
				data-show-columns="true"
				data-show-export="true"
				data-click-to-select="true"
				data-export-types="['xlsx']"
				data-pagination="true"
				>
				<thead>
					<tr>
						<th data-formatter="thIndex" data-align="center" data-width="3%">序号</th>
						<th data-field="type" data-align="center">月报类型</th>
						<th data-field="m1" data-align="center" data-formatter="toM">1月</th>
						<th data-field="m2" data-align="center" data-formatter="toM">2月</th>
						<th data-field="m3" data-align="center" data-formatter="toM">3月</th>
						<th data-field="m4" data-align="center" data-formatter="toM">4月</th>
						<th data-field="m5" data-align="center" data-formatter="toM">5月</th>
						<th data-field="m6" data-align="center" data-formatter="toM">6月</th>
						<th data-field="m7" data-align="center" data-formatter="toM">7月</th>
						<th data-field="m8" data-align="center" data-formatter="toM">8月</th>
						<th data-field="m9" data-align="center" data-formatter="toM">9月</th>
						<th data-field="m10" data-align="center" data-formatter="toM">10月</th>
						<th data-field="m11" data-align="center" data-formatter="toM">11月</th>
						<th data-field="m12" data-align="center" data-formatter="toM">12月</th>
					</tr>
				</thead>
			</table>
		</div>
		<script src="../js/jquery.min.js?v=2.1.4"></script>
		<script src="../js/bootstrap.min.js?v=3.3.5"></script>
		<!-- <script src="js/content.min.js?v=1.0.0"></script> -->
		<script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
		<script src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
		<script src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
		<script src="../js/plugins/layer/layer.js"></script>
		<script src="common.js"></script>
		<script type="text/javascript">
		var $table = $('#table');
		var datas = [];
		$(['主要经济指标月报','主要产出月报','增加值月报','能源消耗月报','新签合同月报','合同储备月报']).each(function(i,e){
			datas.push(getObj(e));
		});
		console.log(datas)
		function getObj(type){
			var obj = {type:type};
			for(var i=1;i<=12;i++){
				if(i<=3) obj['m'+i] = '已下发';
				else if(i==4) obj['m'+i] = '编制中';
				else obj['m'+i] = '未开始';
			}
			return obj;
		}
		$(function(){
			$table.bootstrapTable('load',datas);
		});
		function search(){//查询方法
			$table.bootstrapTable('refresh');
		}
		colorObj = {'已下发':'#4CAF50','编制中':'red','未开始':'#795548'}
		function toM(val){
			return '<a href="javascript:edit();" style="color:'+colorObj[val]+'" >'+val+'</a>';
		}
		function add(){//添加方法(推荐)
			var index = layer.open({
				type: 2,
				title: '新增月报类型',
				content: "form_1.1.html",
				shadeClose: false,
				area: ['90%', '90%'],
				maxmin: true
			});
			//layer.full(index);//自动展开弹出页
		}
		function edit2(){//添加方法(推荐)
			var index = layer.open({
				type: 2,
				title: '新增月报类型',
				content: "table_1.1.1.html",
				shadeClose: false,
				area: ['90%', '90%'],
				maxmin: true
			});
			//layer.full(index);//自动展开弹出页
		}
		
		function getSelections(){//获取所选行方法
			return $table.bootstrapTable('getSelections');
		}
		
		function edit(){//编辑方法(推荐)
			var selRow = getSelections()[0];
			layer.open({
				type: 2,
				title: '月报类型信息',
				content: "form_1.1.html",
				shadeClose: false,
				area: ['90%', '90%'],
				maxmin: true,
				success: function(layero, index) {//可选方法,用于设定弹出页面是否可编辑
					var iframeWin = window[layero.find('iframe')[0]['name']];//得到iframe页的窗口对象
					iframeWin.setData(selRow);//执行子页面写入数据方法
				}
			});
		}
		
		function toDetail(val,row){
			return '<a href="javascript:;" onclick="openDetail(this)">详情</a>';
		}
		
		function openDetail(e){
			var index = $(e).parents('tr').data('index');
			var data = $table.bootstrapTable('getData')[index];
			layer.open({
				type: 2,
				title: '员工信息详情',
				content: contextPath+"/demo/testUserinfoForm.jsp",
				shadeClose: false,
				area: ['90%', '90%'],
				maxmin: true,
				success: function(layero, index) {//子页面加载完后执行
					var iframeWin = window[layero.find('iframe')[0]['name']];//得到iframe页的窗口对象
					iframeWin.setData(data,'read');//执行子页面写入数据方法
				}
			});
		}
		
		function remove(){//删除方法
			var selRows = getSelections();
			if(selRows.length==0){sweetAlert("错误", "请先选择行","error");return;}
			layer.confirm('删除所选项？', {
				btn: ['删除','取消'] //按钮
			}, function(){
				$({datas:selRows}).post('com.primeton.demo.test.deleteTestUserinfos.biz.ext',function(h){
					if(h.exception == null){
						layer.msg('删除成功');
						$table.bootstrapTable('refresh');
					}else{
						layer.msg('删除失败');
					}
				});
			});
		}
		function exports(){
			$('.export li[data-type=xlsx]').click();
		}
		</script>
	</body>
</html>
