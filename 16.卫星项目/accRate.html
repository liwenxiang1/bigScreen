<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="./css/normalize.css">
		<link rel="stylesheet" href="./css/common.css">
		<link rel="stylesheet" href="./css/theme-info.css">
		<link rel="stylesheet" href="./js/swiper/swiper.min.css">
		<link rel="stylesheet" href="./css/animate.min.css">
		<title>项目主题驾驶舱</title>
	</head>

	<body>
		<div class="theme-info theme-wrapper scale-wrapper">
			<div id="loading">
				<div class="loading_img">
					<!-- 加载动画 -->
					<img class="loading-ring-o" src="images/loading-ring-o.png">
					<img class="loading-ring-i" src="images/loading-ring-i.png">
				</div>
			</div>
			<!-- <div class="title-bar">
				<p class="title-name">数据可视化大屏显示</p>
				<span id="time"></span>
				<div class="nav-btn">距离竣工还有 <span> 534 </span> 天</div>
			</div> -->
			<div class="content">
				<div class="c-safe">
					<div class="chart-item">
						<p class="charts-title">单位完成率</p>
						<div class="pj-dn-info">
							<table class="area-table" border cellspacing="0">
								<thead>
									<tr>
										<td colspan="5">单位完成率</td>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>单位名称</td>
										<td>需求数量</td>
										<td>已完成数量</td>
									</tr>
									<tr>
										<td>单位1</td>
										<td>2</td>
										<td>3</td>
									</tr>
									<tr>
										<td>单位2</td>
										<td>2</td>
										<td>3</td>
									</tr>
									<tr>
										<td>单位3</td>
										<td>2</td>
										<td>3</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="c-danger-work">
					<div class="chart-item swiper-container">
						<p class="charts-title">目标类型需求完成率</p>
						<div class="pj-dn-info swiper-wrapper">
							<div class="swiper-slide type-charts" ></div>
							<div class="swiper-slide type-charts" ></div>
							<div class="swiper-slide type-charts" ></div>
						</div>
						<div class="swiper-pagination"></div>
					</div>
				</div>
				<div class="c-danger-work">
					<div class="chart-item swiper-container">
						<p class="charts-title">国家需求完成率</p>
						<div class="pj-dn-info swiper-wrapper">
							<div class="swiper-slide country-charts" ></div>
							<div class="swiper-slide country-charts" ></div>
							<div class="swiper-slide country-charts" ></div>
						</div>
						<div class="swiper-pagination"></div>
					</div>
				</div>
				<div class="c-plan">
					<div class="chart-item">
						<p class="charts-title">需求数量比例</p>
						<div class="pj-dn-info">
							<div id="needRate-charts"></div>
						</div>
					</div>
				</div>
				<div class="c-status">
					<div class="chart-item">
						<p class="charts-title">需求完成次数</p>
						<div class="pj-dn-info">
							<div id="num-charts"></div>
						</div>
					</div>
				</div>
			</div>
			<!-- <div class="c-date">

			</div>

			<div class="c-bottom">
			</div> -->
		</div>
		<script src="./js/jquery-3.2.1.min.js"></script>
		<script src="./js/echarts.min.js"></script>
		<script src="./js/global.js"></script>
		<script src="./js/swiper/swiper.min.js"></script>
		<script type="text/javascript">
			$(function() {
				swiperInit()
				resetTheme()
				scalePage()
				clearLoading()
				accRateInit()
				countryInit()
				needRateInit()
				numInit()
				//全屏
				// $("#fullScreen").on("click",function(){
				//     fullScreen();
				// })
				// //退出全屏
				// $("#exitFullScreen").on("click",function(){
				//     exitFullscreen();
				// })
			})
			swiperInit=()=>{
				var mySwiper = new Swiper('.swiper-container', {
				    direction: 'horizontal', // 垂直切换选项
				    speed: 1000, // 切换速度
				    loop: false, // 循环模式选项
				    autoplay: {
				        delay: 3000 // 3秒切换一次
				    },
				    observer: true,
				    observeParents: true,
				    // 用户操作swiper之后，是否禁止autoplay
				    disableOnInteraction: false,
					pagination: {
					    el: '.swiper-pagination',
						clickable :true,
					  }
				})
			}
			//需求完成次数num-charts
			numInit = () => {
				let numChart = echarts.init(document.getElementById('num-charts'));
				numOption = {

					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'shadow'
						}
					},
					legend: {
						textStyle: {
							color: '#ffffff'
						}
					},
					dataZoom: {
						startValue: 0,
						endValue: 4,
						handleStyle: {
							opacity: 0.2
						},
						yAxisIndex: 0,
						type: "slider"
					},
					grid: {
						left: '3%',
						right: '4%',
						bottom: '3%',
						containLabel: true
					},
					xAxis: {
						type: 'value',
						boundaryGap: [0, 0.01],
						axisLine: {
							lineStyle: {
								color: 'rgba(255,255,255)'
							}
						},
					},
					
					yAxis: {
						type: 'category',
						data: ['Brazil', 'Indonesia', 'USA', 'India', 'China', 'World'],
						axisLine: {
							lineStyle: {
								color: 'rgba(255,255,255)'
							}
						},
					},
					series: [{
							name: '2011',
							type: 'bar',
							data: [18203, 23489, 29034, 104970, 131744, 630230],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#0570E9' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						},
						{
							name: '2012',
							type: 'bar',
							data: [19325, 23438, 31000, 121594, 134141, 681807],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#F80475' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						}
					]
				}
				numChart.setOption(numOption)

				// 窗口尺寸变化时resize
				$(window).resize(function() {
					numChart.resize()
				});
			}
			//需求数量比例
			needRateInit = () => {
				const pjDnData = [{
					value: 233.23,
					name: '已完成'
				}, {
					value: 213.79,
					name: '未完成'
				}]
				let needRateChart = echarts.init(document.getElementById('needRate-charts'));
				needOption = {
					grid: {
						left: 15,
						top: 20,
						bottom: 20,
						right: 15
					},
					tooltip: {
						trigger: 'item',
						formatter: "{b}:{c} ({d}%)"
					},
					title: {
						text: '',
						subtext: '需求数量',
						textStyle: {
							color: '#00FFFE',
							fontSize: 25,
						},
						subtextStyle: {
							fontSize: 20,
							color: '#00FFFE'
						},
						x: '22.5%',
						y: '43%',
					},
					legend: {
						show: true,
						orient: 'vertical',
						top: 0,
						right: 10,
						itemWidth: 10,
						itemHeight: 10,
						itemGap: 0,
						formatter: (name) => {
							let curItem = pjDnData.filter(item => item.name === name)
							console.log("pjDnInit -> curItem", curItem)
							let arr = [
								'{n|' + name + '：' + '}',
								'{m|' + curItem[0].value + '} '
							]
							return arr.join('\n\n')
						},
						textStyle: {
							color: '#fff',
							fontSize: 14,
							rich: {
								n: {
									fontSize: 18,
									color: '#fff',
									padding: [0, 15, 50, 0]
								},
								m: {
									fontSize: 38,
									color: '#20FDFA',
									align: 'left',
									verticalAlign: 'bottom',
									padding: [0, 0, 0, -15]
								},
								u: {
									fontSize: 18,
									color: '#20FDFA',
									verticalAlign: 'bottom'
								}
							}
						}
					},
					series: [{
						type: "pie",
						center: ["30%", "50%"],
						radius: ["40%", "50%"],
						color: ['#FF6D82', '#00AEFF'],
						startAngle: 210,
						// selectedMode: 'single',
						labelLine: {
							length: 10,
							length2: 50,
							lineStyle: {
								type: 'dashed'
							}
						},
						label: {
							normal: {
								formatter: "{b|{d}%}",
								padding: [0, -58, 25, -55],
								rich: {
									b: {
										fontSize: 15
									}
								}
							}
						},
						data: pjDnData
					}]
				}
				needRateChart.setOption(needOption)

				// 窗口尺寸变化时resize
				$(window).resize(function() {
					needRateChart.resize()
				});
			}
			//单位完成率
			accRateInit = () => {
				typeChart = echarts.init(document.getElementsByClassName('type-charts')[0]);
				typeChart1 = echarts.init(document.getElementsByClassName('type-charts')[1]);
				typeChart2 = echarts.init(document.getElementsByClassName('type-charts')[2]);
				typeOption = {
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'cross',
							crossStyle: {
								color: '#fff'
							}
						}
					},
					// dataZoom: {
					// 	startValue: 0,
					// 	endValue: 4,
					// 	handleStyle: {
					// 		opacity: 0.2
					// 	},
					// 	type: "slider"
					// },
					toolbox: {
						feature: {
							// dataView: { show: true, readOnly: false },
							magicType: {
								show: true,
								type: ['line', 'bar']
							},
							restore: {
								show: true
							},
							// saveAsImage: { show: true }
						}
					},
					legend: {
						data: ['完成总数', '未完成', '完成率'],
						textStyle: {
							color: '#ffffff'
						}
					},
					xAxis: [{
						type: 'category',
						data: ['类别1', '类别1', '类别1', '类别1', '类别1'],
						axisLine: {
							lineStyle: {
								color: 'rgba(255,255,255,0.12)'
							}
						},
						axisPointer: {
							type: 'shadow'
						},
						axisLabel: {
							show: true,
							textStyle: {
								color: "#f6f6f6", //X轴文字颜色
								fontSize: 11
							}
						},
					}],
					yAxis: [{
							type: 'value',
							name: '完成数',
							min: 0,
							max: 50,
							interval: 10,
							axisLabel: {
								formatter: '{value} '
							},
							axisLine: {
								lineStyle: {
									color: 'rgba(255,255,255)'
								}
							},
						},
						{
							type: 'value',
							name: '百分比',
							min: 0,
							max: 25,
							interval: 5,
							axisLabel: {
								formatter: '{value} %'
							},
							axisLine: {
								lineStyle: {
									color: 'rgba(255,255,255)'
								}
							},
						}
					],
					series: [{
							name: '完成总数',
							type: 'bar',
							data: [
								2.0, 4.9, 7.0, 23.2, 25.6
							],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#0570E9' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						},
						{
							name: '未完成',
							type: 'bar',
							data: [
								2.6, 5.9, 9.0, 26.4, 28.7
							],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#F80475' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						},
						{
							name: '完成率',
							type: 'line',
							yAxisIndex: 1,
							data: [2.0, 2.2, 3.3, 4.5, 6.3],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#FCCC04' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						}
					]
				}
				typeChart.setOption(typeOption)
				typeChart1.setOption(typeOption)
				typeChart2.setOption(typeOption)
				let toolTipIndex = 0; // 轮播所在下标
				setInterval(() => {
					// toolTip轮播
					typeChart.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					typeChart1.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					typeChart2.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					toolTipIndex++;
					if (toolTipIndex > typeOption.series[0].data.length) {
						toolTipIndex = 0;
					}
				}, 2000)

				// 窗口尺寸变化时resize
				$(window).resize(function() {
					typeChart.resize()
				});
			}
			//国家完成率
			countryInit = () => {
				countryChart = echarts.init(document.getElementsByClassName('country-charts')[0]);
				countryChart1 = echarts.init(document.getElementsByClassName('country-charts')[1]);
				countryChart2= echarts.init(document.getElementsByClassName('country-charts')[2]);
				countryOption = {
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'cross',
							crossStyle: {
								color: '#fff'
							}
						}
					},
					// dataZoom: {
					// 	startValue: 0,
					// 	endValue: 4,
					// 	handleStyle: {
					// 		opacity: 0.2
					// 	},
					// 	type: "slider"
					// },
					toolbox: {
						feature: {
							// dataView: { show: true, readOnly: false },
							magicType: {
								show: true,
								type: ['line', 'bar']
							},
							restore: {
								show: true
							},
							// saveAsImage: { show: true }
						}
					},
					legend: {
						data: ['完成总数', '未完成', '完成率'],
						textStyle: {
							color: '#ffffff'
						}
					},
					xAxis: [{
						type: 'category',
						data: ['类别1', '类别1', '类别1', '类别1', '类别1'],
						axisLine: {
							lineStyle: {
								color: 'rgba(255,255,255,0.12)'
							}
						},
						axisPointer: {
							type: 'shadow'
						},
						axisLabel: {
							show: true,
							textStyle: {
								color: "#f6f6f6", //X轴文字颜色
								fontSize: 11
							}
						},
					}],
					yAxis: [{
							type: 'value',
							name: '完成数',
							min: 0,
							max: 50,
							interval: 10,
							axisLabel: {
								formatter: '{value} '
							},
							axisLine: {
								lineStyle: {
									color: 'rgba(255,255,255)'
								}
							},
						},
						{
							type: 'value',
							name: '百分比',
							min: 0,
							max: 25,
							interval: 5,
							axisLabel: {
								formatter: '{value} %'
							},
							axisLine: {
								lineStyle: {
									color: 'rgba(255,255,255)'
								}
							},
						}
					],
					series: [{
							name: '完成总数',
							type: 'bar',
							data: [
								2.0, 4.9, 7.0, 23.2, 25.6
							],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#0570E9' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						},
						{
							name: '未完成',
							type: 'bar',
							data: [
								2.6, 5.9, 9.0, 26.4, 28.7
							],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#F80475' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						},
						{
							name: '完成率',
							type: 'line',
							yAxisIndex: 1,
							data: [2.0, 2.2, 3.3, 4.5, 6.3],
							itemStyle: {
								normal: {
									color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
										offset: 0,
										color: '#0ECFF8' // 0% 处的颜色
									}, {
										offset: 1,
										color: '#FCCC04' // 100% 处的颜色
									}], false),
									shadowBlur: 4,
								}
							}
						}
					]
				}
				countryChart.setOption(countryOption)
				countryChart1.setOption(countryOption)
				countryChart2.setOption(countryOption)
				let toolTipIndex = 0; // 轮播所在下标
				setInterval(() => {
					// toolTip轮播
					countryChart.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					countryChart1.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					countryChart2.dispatchAction({
						type: 'showTip',
						seriesIndex: 0,
						dataIndex: toolTipIndex
					});
					toolTipIndex++;
					if (toolTipIndex > countryOption.series[0].data.length) {
						toolTipIndex = 0;
					}
				}, 2000)

				// 窗口尺寸变化时resize
				$(window).resize(function() {
					countryChart.resize()
				});
			}

			clearLoading = () => {
				//删除加载动画
				$('#loading').fadeOut(1000)
				setTimeout(function() {
					$('#loading').remove()
				}, 1000);
			}

			timeInit = () => {
				setInterval(() => {
					let date = new Date()
					$('#time').text(getFormatDate)
				}, 1000);
			}
			getFormatDate = () => {
				let nowDate = new Date();
				let year = nowDate.getFullYear();
				let month = nowDate.getMonth() + 1 < 10 ? "0" + (nowDate.getMonth() + 1) : nowDate.getMonth() + 1;
				let date = nowDate.getDate() < 10 ? "0" + nowDate.getDate() : nowDate.getDate();
				let hour = nowDate.getHours() < 10 ? "0" + nowDate.getHours() : nowDate.getHours();
				let minute = nowDate.getMinutes() < 10 ? "0" + nowDate.getMinutes() : nowDate.getMinutes();
				let second = nowDate.getSeconds() < 10 ? "0" + nowDate.getSeconds() : nowDate.getSeconds();
				return year + "-" + month + "-" + date + " " + hour + ":" + minute + ":" + second;
			}
			getScale = () => {
				// 固定好16:9的宽高比，计算出最合适的缩放比，宽高比可根据需要自行更改
				const width = 1920
				const height = 1080
				let ww = window.innerWidth / width
				let wh = window.innerHeight / height
				return ww < wh ? ww : wh
			}
			// 页面渲染计算比例缩放
			scalePage = () => {
				setScale = debounce(() => {
					// 获取到缩放比，设置它
					let scale = this.getScale()
					$('.scale-wrapper').css({
						'transform': 'scale(' + scale + ') translate(-50%, -50%)',
						'-webkit-transform': 'scale(' + scale + ') translate(-50%, -50%)'
					})
				}, 200)
				setScale()
				window.addEventListener('resize', setScale)
			}
			// 防抖
			debounce = (fun, delay) => {
				let timer
				return function() {
					if (timer) {
						clearTimeout(timer)
					}
					timer = setTimeout(fun, delay)
				}
			}
		</script>
	</body>

</html>
